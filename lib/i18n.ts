"use client";
import { useAppStore } from "@/lib/store";

export type Lang = "en" | "th";

type Dict = Record<string, any>;

const dict: Record<Lang, Dict> = {
  en: {
    nav: {
      products: "Products",
      boosts: "Boosts",
      analytics: "Analytics",
      settings: "Settings",
    },
    crumbs: {
      home: "Home",
      dashboard: "Dashboard",
      products: "Products",
      orders: "Orders",
      shipping: "Shipping",
      payouts: "Payouts",
      settings: "Settings",
      analytics: "Analytics",
      boosts: "Boosts",
    },
    common: {
      signOut: "Sign out",
      loading: "Loading…",
      redirecting: "Redirecting…",
      noData: "No data",
      notAvailable: "Not available",
      actions: "Actions",
      confirm: "Confirm",
      cancel: "Cancel",
    },
    settings: {
      title: "Settings",
      signedInEmail: "Signed in email",
      contactSupport: "Contact support",
      contactLine: "If you have any questions or inquiries, please contact support at",
      language: "Language",
      langEn: "English",
      langTh: "Thai",
    },
    boosts: {
      title: "Boosts",
      whatIs: "What is Boost?",
      whatIsLine1: "Boost promotes your selected products to more shoppers across Myswipes for 3 days, giving your listings extra exposure and priority placement to drive more impressions and clicks.",
      whatIsLine2: "Each boost lasts 3 days per product at {price}. Choose the products you want to highlight and check out to start the boost.",
      promote: "Promote a product",
      perProduct: "3 days • {price} per product",
      product: "Product",
      price: "Price",
      status: "Status",
      checkout: "Checkout to Boost",
      live: "Live boosted listings",
      previous: "Previous boosted listings",
      loading: "Loading...",
      noBoosts: "No boosts yet.",
      noLive: "No live boosts.",
      noPrev: "No previous boosts.",
      cancel: "Cancel",
      boosting: "Boosting",
      noEligible: "No eligible products",
      cancelConfirm: { title: "Cancel boost", desc: "This will stop the boost immediately." },
      start: "Start",
      end: "End",
      toasts: {
        selectOne: "Select at least 1 eligible product",
        checkoutMissing: "Checkout link not available",
        cancelled: "Boost cancelled",
        activated: "Activated {count} boosts",
        noActivated: "No boosts activated (may have been activated already)",
        waitingPayment: "Waiting for payment confirmation...",
      },
    },
    analytics: {
      title: "Analytics",
      last7: "Last 7 days",
      last30: "Last 30 days",
      understand: "Understand your metrics",
      metrics: {
        impressions: ["Impressions", "Times your products were seen."],
        clicks: ["Clicks", "Taps that opened your product."],
        ctr: ["CTR", "Click-through rate (clicks ÷ impressions)."],
        saves: ["Saves", "Shoppers who saved your product."],
        saveRate: ["Save rate", "Saves ÷ impressions (interest)."],
      },
      metricsText: {
        impressions: "Times your products were seen.",
        clicks: "Taps that opened your product.",
        ctr: "Click-through rate (clicks ÷ impressions).",
        saves: "Shoppers who saved your product.",
        saveRate: "Saves ÷ impressions (interest).",
      },
      topProducts: "Top products",
      topDesc: "Your best-performing products in the selected window, ranked by clicks. Use CTR and Save rate to spot items that attract attention and interest.",
      daily: "Daily metrics",
      dailyDesc: "Day-by-day impressions, clicks, and saves over your selected window. Look for trends and spikes when running deals or boosts.",
      date: "Date",
      imprShort: "Impr.",
      clicks: "Clicks",
      saves: "Saves",
      ctr: "CTR",
      saveRate: "Save rate",
      whatIs: "What is this?",
    },
    products: {
      title: "Products",
      modesTitle: "Listing modes: Discover vs Deals",
      discover: "Discover shows your products in shoppers' personalized feed throughout the day. Use Discover to build steady exposure over time.",
      deals: "Deals is a 1-hour daily window where discounted products are featured prominently. Aim for high discounts to maximize visibility. If you have a coupon, add it so buyers can apply it at checkout.",
      tabs: {
        all: "All",
        active: "Active",
        pending: "Pending",
      },
      pendingTitle: "Pending listings",
      pendingDesc: "Products in Pending have been submitted and are awaiting admin approval. Reviews may take up to 48 hours.",
      searchPlaceholder: "Search by name",
      filters: {
        title: "Filters",
        mode: "Mode",
        minDiscount: "Min discount",
        pageSize: "{n} / page",
      },
      buttons: {
        submitReview: "Submit for review",
        deleteSelected: "Delete selected",
        addProduct: "Add Product",
        close: "Close",
      },
      columns: {
        product: "Product",
        price: "Price",
        mode: "Mode",
        discount: "Discount",
        coupon: "Coupon",
        status: "Status",
      },
      modeLabels: { discover: "Discover", deal: "Deals" },
      dealTag: "DEAL",
      none: "No products found.",
      confirmDelete: {
        title: "Delete selected",
        desc: "This will remove the selected products.",
      },
      toasts: {
        deleted: "Deleted {count} products",
        submitted: "Submitted {count} for review",
        accountDisabled: "Your seller account is disabled.",
        verifyOpenForm: "Could not verify seller status. Opening form.",
        verifyOpenEditor: "Could not verify seller status. Attempting to open editor.",
        openFailed: "Failed to open product",
      }
    },
    login: {
      title: "Welcome",
      email: "Email",
      password: "Password",
      signIn: "Sign in",
      signingIn: "Signing in…",
      continueGoogle: "Continue with Google",
      googleError: "Unable to start Google sign-in",
      note: "Using this dashboard will create a seller account for you after login.",
    },
    status: {
      active: "active",
      draft: "draft",
      pending_review: "pending",
      paid: "paid",
      fulfilled: "fulfilled",
      in_transit: "in transit",
      refunded: "refunded",
    }
  },
  th: {
    nav: {
      products: "สินค้า",
      boosts: "บูสต์",
      analytics: "สถิติ",
      settings: "การตั้งค่า",
    },
    crumbs: {
      home: "หน้าแรก",
      dashboard: "แดชบอร์ด",
      products: "สินค้า",
      orders: "คำสั่งซื้อ",
      shipping: "การจัดส่ง",
      payouts: "การจ่ายเงิน",
      settings: "การตั้งค่า",
      analytics: "สถิติ",
      boosts: "บูสต์",
    },
    common: {
      signOut: "ออกจากระบบ",
      loading: "กำลังโหลด…",
      redirecting: "กำลังเปลี่ยนหน้า…",
      noData: "ไม่มีข้อมูล",
      notAvailable: "ไม่มี",
      actions: "การทำงาน",
      confirm: "ยืนยัน",
      cancel: "ยกเลิก",
    },
    settings: {
      title: "การตั้งค่า",
      signedInEmail: "อีเมลที่ลงชื่อเข้าใช้",
      contactSupport: "ติดต่อฝ่ายสนับสนุน",
      contactLine: "หากมีคำถามหรือต้องการความช่วยเหลือ โปรดติดต่อที่",
      language: "ภาษา",
      langEn: "อังกฤษ",
      langTh: "ไทย",
    },
    boosts: {
      title: "บูสต์",
      whatIs: "บูสต์คืออะไร?",
      whatIsLine1: "บูสต์ช่วยโปรโมตสินค้าให้เข้าถึงผู้ซื้อบน Myswipes มากขึ้นเป็นเวลา 3 วัน เพิ่มการมองเห็นและจัดวางให้เด่นขึ้น เพื่อเพิ่มการแสดงผลและคลิก",
      whatIsLine2: "แต่ละการบูสต์มีอายุ 3 วันต่อสินค้า ในราคา {price} เลือกสินค้าที่ต้องการและชำระเงินเพื่อเริ่มบูสต์",
      promote: "โปรโมตสินค้า",
      perProduct: "3 วัน • {price} ต่อสินค้า",
      product: "สินค้า",
      price: "ราคา",
      status: "สถานะ",
      checkout: "ชำระเงินเพื่อบูสต์",
      live: "รายการที่กำลังบูสต์อยู่",
      previous: "รายการที่บูสต์แล้วสิ้นสุด",
      loading: "กำลังโหลด...",
      noBoosts: "ยังไม่มีการบูสต์",
      noLive: "ไม่มีการบูสต์ที่กำลังใช้งาน",
      noPrev: "ไม่มีการบูสต์ก่อนหน้า",
      cancel: "ยกเลิก",
      boosting: "กำลังบูสต์",
      noEligible: "ไม่มีสินค้าที่เข้าเกณฑ์",
      cancelConfirm: { title: "ยกเลิกการบูสต์", desc: "การบูสต์จะหยุดทันที" },
      start: "เริ่ม",
      end: "สิ้นสุด",
      toasts: {
        selectOne: "เลือกสินค้าอย่างน้อย 1 รายการ",
        checkoutMissing: "ไม่พบลิงก์ชำระเงิน",
        cancelled: "ยกเลิกการบูสต์แล้ว",
        activated: "เปิดใช้งานการบูสต์ {count} รายการ",
        noActivated: "ไม่มีการบูสต์ที่เปิดใช้งาน (อาจถูกเปิดใช้งานแล้ว)",
        waitingPayment: "กำลังรอยืนยันการชำระเงิน...",
      },
    },
    analytics: {
      title: "สถิติ",
      last7: "7 วันล่าสุด",
      last30: "30 วันล่าสุด",
      understand: "ทำความเข้าใจตัวชี้วัด",
      metrics: {
        impressions: ["การแสดงผล", "จำนวนครั้งที่สินค้าของคุณถูกมองเห็น"],
        clicks: ["คลิก", "จำนวนการแตะเพื่อเปิดดูสินค้า"],
        ctr: ["CTR", "อัตราการคลิก (คลิก ÷ การแสดงผล)"],
        saves: ["บันทึก", "จำนวนครั้งที่ผู้ซื้อบันทึกสินค้า"],
        saveRate: ["อัตราการบันทึก", "บันทึก ÷ การแสดงผล (วัดความสนใจ)"],
      },
      metricsText: {
        impressions: "จำนวนครั้งที่สินค้าของคุณถูกมองเห็น",
        clicks: "จำนวนการแตะเพื่อเปิดดูสินค้า",
        ctr: "อัตราการคลิก (คลิก ÷ การแสดงผล)",
        saves: "จำนวนครั้งที่ผู้ซื้อบันทึกสินค้า",
        saveRate: "บันทึก ÷ การแสดงผล (วัดความสนใจ)",
      },
      topProducts: "สินค้ายอดนิยม",
      topDesc: "สินค้าที่ทำผลงานดีที่สุดในช่วงเวลาที่เลือก เรียงตามจำนวนคลิก ใช้ CTR และอัตราการบันทึกเพื่อดูความสนใจ",
      daily: "สถิติรายวัน",
      dailyDesc: "การแสดงผล คลิก และบันทึกในแต่ละวัน ดูแนวโน้มและจุดพีคเมื่อมีดีลหรือบูสต์",
      date: "วันที่",
      imprShort: "การแสดงผล",
      clicks: "คลิก",
      saves: "บันทึก",
      ctr: "CTR",
      saveRate: "อัตราการบันทึก",
      whatIs: "นี่คืออะไร?",
    },
    products: {
      title: "สินค้า",
      modesTitle: "โหมดการแสดง: ดิสคัฟเวอร์ vs ดีล",
      discover: "ดิสคัฟเวอร์จะแสดงสินค้าในฟีดส่วนบุคคลของผู้ซื้อทั้งวัน เหมาะสำหรับสร้างการมองเห็นอย่างต่อเนื่อง",
      deals: "ดีลคือช่วงเวลา 1 ชั่วโมงต่อวัน ที่สินค้าลดราคาจะถูกนำเสนอเด่นเป็นพิเศษ ควรตั้งส่วนลดสูงเพื่อเพิ่มการมองเห็น หากมีคูปองให้ใส่เพื่อให้ลูกค้าใช้งานตอนชำระเงิน",
      tabs: {
        all: "ทั้งหมด",
        active: "เปิดใช้งาน",
        pending: "รอตรวจสอบ",
      },
      pendingTitle: "รายการรอตรวจสอบ",
      pendingDesc: "สินค้าที่อยู่ในสถานะรอตรวจสอบได้ส่งคำขอแล้วและกำลังรอผู้ดูแลอนุมัติ โดยอาจใช้เวลาสูงสุด 48 ชั่วโมง",
      searchPlaceholder: "ค้นหาตามชื่อ",
      filters: {
        title: "ตัวกรอง",
        mode: "โหมด",
        minDiscount: "ส่วนลดขั้นต่ำ",
        pageSize: "{n} / หน้า",
      },
      buttons: {
        submitReview: "ส่งเพื่อตรวจสอบ",
        deleteSelected: "ลบที่เลือก",
        addProduct: "เพิ่มสินค้า",
        close: "ปิด",
      },
      columns: {
        product: "สินค้า",
        price: "ราคา",
        mode: "โหมด",
        discount: "ส่วนลด",
        coupon: "คูปอง",
        status: "สถานะ",
      },
      modeLabels: { discover: "ดิสคัฟเวอร์", deal: "ดีล" },
      dealTag: "ดีล",
      none: "ไม่พบสินค้า",
      confirmDelete: {
        title: "ลบที่เลือก",
        desc: "รายการสินค้าที่เลือกจะถูกลบ",
      },
      toasts: {
        deleted: "ลบสินค้า {count} รายการ",
        submitted: "ส่ง {count} รายการเพื่อตรวจสอบแล้ว",
        accountDisabled: "บัญชีผู้ขายของคุณถูกปิดการใช้งาน",
        verifyOpenForm: "ไม่สามารถยืนยันสถานะผู้ขาย เปิดแบบฟอร์ม",
        verifyOpenEditor: "ไม่สามารถยืนยันสถานะผู้ขาย กำลังเปิดหน้าต่างแก้ไข",
        openFailed: "ไม่สามารถเปิดสินค้า",
      }
    },
    login: {
      title: "ลงชื่อเข้าใช้",
      email: "อีเมล",
      password: "รหัสผ่าน",
      signIn: "ลงชื่อเข้าใช้",
      signingIn: "กำลังลงชื่อเข้าใช้…",
      continueGoogle: "ลงชื่อเข้าใช้ด้วย Google",
      googleError: "ไม่สามารถเริ่มการลงชื่อเข้าใช้ด้วย Google ได้",
      note: "การใช้งานแดชบอร์ดนี้จะสร้างบัญชีผู้ขายให้คุณหลังจากลงชื่อเข้าใช้",
    },
    status: {
      active: "เปิดใช้งาน",
      draft: "ฉบับร่าง",
      pending_review: "รอตรวจสอบ",
      paid: "ชำระแล้ว",
      fulfilled: "จัดส่งสำเร็จ",
      in_transit: "ระหว่างขนส่ง",
      refunded: "คืนเงินแล้ว",
    }
  },
};

function get(obj: any, path: string): string {
  const parts = path.split(".");
  let cur = obj as any;
  for (const p of parts) {
    if (cur && typeof cur === "object" && p in cur) cur = cur[p]; else return path;
  }
  if (Array.isArray(cur)) return cur[0];
  return typeof cur === "string" ? cur : path;
}

export function useT() {
  const lang = useAppStore((s) => s.lang) as Lang;
  const setLang = useAppStore((s) => s.setLang);
  const t = (key: string, vars?: Record<string, string | number>) => {
    const base = get(dict[lang] || dict.en, key);
    if (!vars) return base;
    return Object.keys(vars).reduce((acc, k) => acc.replace(new RegExp(`{${k}}`, "g"), String(vars[k])), base);
  };
  return { t, lang, setLang };
}
